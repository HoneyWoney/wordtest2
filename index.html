<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ì˜ë‹¨ì–´ í€´ì¦ˆ ê²Œì„</title>
  <style>
    /* ë°°ê²½ & ì „ì²´ */
    body {
      margin: 0; padding: 0;
      background: #FFFAF0;
      font-family: 'ë§‘ì€ ê³ ë”•', Apple SD Gothic Neo, sans-serif;
    }
    .container {
      max-width: 500px;
      margin: 40px auto;
      padding: 20px;
      background: #fff;
      border-radius: 20px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      text-align: center;
    }
    h1 { margin-bottom: 20px; color: #FF6F91; }
    /* ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
    button {
      margin: 8px;
      padding: 10px 20px;
      font-size: 1em;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      background: #FFD3B6;
      transition: transform .1s;
    }
    button:hover { transform: scale(1.05); }
    /* ì…ë ¥ì°½ */
    input[type="text"] {
      padding: 8px;
      font-size: 1em;
      border: 2px solid #FF6F91;
      border-radius: 10px;
      width: 80%;
    }
    /* ë¬¸ì œ/ë³´ê¸°/í”¼ë“œë°± */
    #question-num { font-size: 0.9em; color: #AAA; }
    #question-area {
      margin: 20px 0;
      font-size: 1.3em;
      color: #FF6F91;
    }
    .options { display: flex; flex-direction: column; }
    .options button { background: #CBE7E0; }
    #feedback {
      margin: 15px 0;
      font-size: 1.1em;
      min-height: 1.2em;
    }
    #next-btn { background: #A29BFE; }
    /* ê²°ê³¼í™”ë©´ */
    #result-screen h2 { color: #FF6F91; }
    #response { margin-top: 10px; font-size: 0.9em; color: #333; }
  </style>
</head>
<body>
  <div class="container">

    <!-- ì‹œì‘ í™”ë©´ -->
    <div id="start-screen">
      <h1>ì˜ë‹¨ì–´ í€´ì¦ˆ</h1>
      <p>ì´ë¦„ì„ ì…ë ¥í•˜ê³  ì‹œì‘ ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”!</p>
      <input type="text" id="name-input" placeholder="ì´ë¦„"/>
      <br/>
      <button id="start-btn">ì‹œì‘í•˜ê¸°</button>
    </div>

    <!-- í€´ì¦ˆ í™”ë©´ -->
    <div id="quiz-screen" style="display:none;">
      <div id="question-num"></div>
      <div id="question-area"></div>
      <div class="options" id="options-area"></div>
      <div id="input-area" style="margin:10px 0;"></div>
      <div id="feedback"></div>
      <button id="next-btn" style="display:none;">ë‹¤ìŒ</button>
    </div>

    <!-- ê²°ê³¼ í™”ë©´ -->
    <div id="result-screen" style="display:none;">
      <h2>ğŸ‰ ê²°ê³¼ ğŸ‰</h2>
      <p id="score-display"></p>
      <button id="submit-btn">ì ìˆ˜ ì „ì†¡</button>
      <p id="response"></p>
    </div>

  </div>

  <script>
    // --- 1) ë‹¨ì–´ ëª©ë¡ (ì²« ë²ˆì§¸ ì‹œíŠ¸ 50ê°œ + ë‘ ë²ˆì§¸ ì‹œíŠ¸ 50ê°œ = 100ê°œ) ---
    const vocabList = [
      {word:"fierce",     meaning:"ê²©ë ¬í•œ"},
      {word:"greed",      meaning:"íƒìš•"},
      {word:"oval",       meaning:"íƒ€ì›í˜•ì˜"},
      {word:"odd",        meaning:"ì´ìƒí•œ, í™€ìˆ˜ì˜"},
      {word:"forehead",   meaning:"ì´ë§ˆ"},
      {word:"ignorant",   meaning:"ë¬´ì§€í•œ, ë¬´ì‹í•œ"},
      {word:"beard",      meaning:"í„±ìˆ˜ì—¼"},
      {word:"wrist",      meaning:"ì†ëª©"},
      {word:"thigh",      meaning:"í—ˆë²…ì§€"},
      {word:"wrinkle",    meaning:"ì£¼ë¦„"},
      {word:"even",       meaning:"ì§ìˆ˜ì˜"},
      {word:"peculiar",   meaning:"ì´ìƒí•œ"},
      {word:"ambition",   meaning:"ì•¼ë§"},
      {word:"offensive",  meaning:"ê³µê²©ì ì¸"},
      {word:"modest",     meaning:"ê²¸ì†í•œ"},
      {word:"incapable",  meaning:"~í•  ìˆ˜ ì—†ëŠ”"},
      {word:"appear",     meaning:"~ì¸ ê²ƒ ê°™ë‹¤, ë‚˜íƒ€ë‚˜ë‹¤"},
      {word:"mood",       meaning:"ë¶„ìœ„ê¸°"},
      {word:"sorrow",     meaning:"ìŠ¬í””"},
      {word:"emotion",    meaning:"ê°ì •"},
      {word:"anxious",    meaning:"ê±±ì •í•˜ëŠ”, ë¶ˆì•ˆí•œ"},
      {word:"grief",      meaning:"ìŠ¬í””"},
      {word:"terrible",   meaning:"ë”ì°í•œ"},
      {word:"ashamed",    meaning:"ë¶€ë„ëŸ¬ì›Œí•˜ëŠ”"},
      {word:"depression", meaning:"ìš°ìš¸, ë¶ˆê²½ê¸°"},
      {word:"uneasy",     meaning:"ë¶ˆì•ˆí•œ"},
      {word:"depressed",  meaning:"ìš°ìš¸í•œ"},
      {word:"weep",       meaning:"ìš¸ë‹¤"},
      {word:"annoy",      meaning:"ì§œì¦ë‚˜ê²Œ í•˜ë‹¤"},
      {word:"relieve",    meaning:"ì™„í™”í•˜ë‹¤"},
      {word:"amaze",      meaning:"ë†€ë¼ê²Œ í•˜ë‹¤"},
      {word:"sentiment",  meaning:"ê°ì •"},
      {word:"envy",       meaning:"ë¶€ëŸ¬ì›Œí•˜ë‹¤"},
      {word:"relief",     meaning:"ì•ˆì‹¬"},
      {word:"jealous",    meaning:"ì§ˆíˆ¬í•˜ëŠ”"},
      {word:"nerve",      meaning:"ì‹ ê²½, ìš©ê¸°"},
      {word:"envious",    meaning:"ë¶€ëŸ¬ì›Œí•˜ëŠ”"},
      {word:"be jealous of",meaning:"~ì„ ì§ˆíˆ¬í•˜ë‹¤"},
      {word:"temper",     meaning:"í™”, ê¸°ì§ˆ"},
      {word:"resent",     meaning:"ë¶„ê°œí•˜ë‹¤"},
      {word:"desperate",  meaning:"ì ˆë§ì ì¸"},
      {word:"awful",      meaning:"ì•„ì£¼ ì‹¬í•œ"},
      {word:"resentful",  meaning:"ë¶„ê°œí•˜ëŠ”"},
      {word:"miserable",  meaning:"ë¹„ì°¸í•œ"},
      {word:"disgust",    meaning:"ì—­ê²¹ê²Œ í•˜ë‹¤"},
      {word:"astound",    meaning:"ë†€ë¼ê²Œ í•˜ë‹¤"},
      {word:"frighten",   meaning:"ë¬´ì„­ê²Œ í•˜ë‹¤"},
      {word:"panic",      meaning:"ê³µí¬ì— ì§ˆë¦¬ë‹¤"},
      {word:"disgusting", meaning:"ì—­ê²¨ìš´"},
      {word:"fright",     meaning:"ê³µí¬"},
      // ë‘ ë²ˆì§¸ ì‹œíŠ¸
      {word:"awake",       meaning:"ê¹¨ì–´ ìˆëŠ”, ê¹¨ìš°ë‹¤"},
      {word:"remind",      meaning:"ìƒê¸°ì‹œí‚¤ë‹¤"},
      {word:"niece",       meaning:"ì¡°ì¹´"},
      {word:"engage",      meaning:"ì•½ì†í•˜ë‹¤, ì¢…ì‚¬í•˜ë‹¤"},
      {word:"whisper",     meaning:"ì†ì‚­ì´ë‹¤"},
      {word:"celebrate",   meaning:"ê¸°ë…í•˜ë‹¤"},
      {word:"anniversary", meaning:"ê¸°ë…ì¼"},
      {word:"fate",        meaning:"ìš´ëª…"},
      {word:"advise",      meaning:"ì¶©ê³ í•˜ë‹¤"},
      {word:"lifespan",    meaning:"ì¼ìƒ"},
      {word:"elder",       meaning:"ì—°ì¥ì, ì–´ë¥¸"},
      {word:"parental",    meaning:"ë¶€ëª¨ì˜"},
      {word:"breed",       meaning:"ë‚³ë‹¤, ê¸°ë¥´ë‹¤, í’ˆì¢…"},
      {word:"obedient",    meaning:"ìˆœì¢…í•˜ëŠ”"},
      {word:"treat",       meaning:"ëŒ€ìš°í•˜ë‹¤, ì¹˜ë£Œí•˜ë‹¤"},
      {word:"interact",    meaning:"ìƒí˜¸ì‘ìš©í•˜ë‹¤"},
      {word:"contact",     meaning:"ì—°ë½, ì ‘ì´‰"},
      {word:"relationship",meaning:"ê´€ê³„"},
      {word:"funeral",     meaning:"ì¥ë¡€ì‹"},
      {word:"behave",      meaning:"í–‰ë™í•˜ë‹¤"},
      {word:"sibling",     meaning:"í˜•ì œìë§¤"},
      {word:"resemble",    meaning:"ë‹®ë‹¤"},
      {word:"background",  meaning:"ë°°ê²½"},
      {word:"daycare",     meaning:"ë³´ìœ¡ì˜"},
      {word:"pregnant",    meaning:"ì„ì‹ í•œ"},
      {word:"nurture",     meaning:"ì–‘ìœ¡í•˜ë‹¤"},
      {word:"accompany",   meaning:"ë™í–‰í•˜ë‹¤"},
      {word:"mature",      meaning:"ì„±ìˆ™í•œ"},
      {word:"spouse",      meaning:"ë°°ìš°ì"},
      {word:"bouquet",     meaning:"ê½ƒë‹¤ë°œ"},
      {word:"shape",       meaning:"ëª¨ì–‘, ëª¨ìŠµ"},
      {word:"appearance",  meaning:"ì™¸ê´€, ì¶œí˜„"},
      {word:"personality", meaning:"ì„±ê²©, ê°œì„±"},
      {word:"gender",      meaning:"ì„±ë³„"},
      {word:"impression",  meaning:"ì¸ìƒ"},
      {word:"typical",     meaning:"ì „í˜•ì ì¸"},
      {word:"capable",     meaning:"ìœ ëŠ¥í•œ, ~ëŠ¥ë ¥ìˆëŠ”"},
      {word:"attractive",  meaning:"ë§¤ë ¥ì ì¸, ì‚¬ëŒì„ë„ëŠ”"},
      {word:"active",      meaning:"ì ê·¹ì ì¸, í™œë™ì ì¸"},
      {word:"passive",     meaning:"ìˆ˜ë™ì ì¸"},
      {word:"diligent",    meaning:"ë¶€ì§€ëŸ°í•œ"},
      {word:"bold",        meaning:"ëŒ€ë‹´í•œ"},
      {word:"confident",   meaning:"í™•ì‹ í•˜ëŠ”"},
      {word:"impatient",   meaning:"ì„±ê¸‰í•œ"},
      {word:"ambitious",   meaning:"ì•¼ë§ ìˆëŠ”"},
      {word:"brilliant",   meaning:"í›Œë¥­í•œ"},
      {word:"elegant",     meaning:"ìš°ì•„í•œ"},
      {word:"humble",      meaning:"ê²¸ì†í•œ, ì´ˆë¼í•œ"},
      {word:"arrogant",    meaning:"ì˜¤ë§Œí•œ"},
      {word:"aggressive",  meaning:"ê³µê²©ì ì¸"}
    ];

    // --- ì „ì—­ ë³€ìˆ˜ ---
    let playerName = "";
    let currentSet = 1;
    let qIndex = 0;
    let score = 0;
    let startTime;

    // --- ìœ í‹¸: ë°°ì—´ ì„ê¸° ---
    function shuffle(arr) {
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr;
    }

    // --- ì‹œì‘ ---
    document.getElementById("start-btn").onclick = () => {
      const nameInput = document.getElementById("name-input").value.trim();
      if (!nameInput) { alert("ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!"); return; }
      playerName = nameInput;
      document.getElementById("start-screen").style.display = "none";
      document.getElementById("quiz-screen").style.display = "block";
      startTime = Date.now();
      runQuestion();
    };

    // --- ë¬¸ì œ ì‹¤í–‰ ---
    function runQuestion() {
      const total = vocabList.length;
      document.getElementById("question-num").innerText = 
        `${currentSet}ì„¸íŠ¸: ${qIndex+1} / ${total}`;
      document.getElementById("feedback").innerText = "";
      document.getElementById("next-btn").style.display = "none";
      
      const item = vocabList[qIndex];
      const qaArea = document.getElementById("question-area");
      const optsArea = document.getElementById("options-area");
      const inputArea = document.getElementById("input-area");
      optsArea.innerHTML = "";
      inputArea.innerHTML = "";

      // 1ì„¸íŠ¸: ê°ê´€ì‹
      if (currentSet === 1) {
        qaArea.innerText = `ğŸ“ ë‹¨ì–´: ${item.word}`;
        // ë³´ê¸° 4ê°œ ë½‘ê¸°
        const choices = shuffle([
          item.meaning,
          ...shuffle(vocabList.filter(v=>v.meaning!==item.meaning))
            .slice(0,3).map(v=>v.meaning)
        ]);
        choices.forEach(ch => {
          const btn = document.createElement("button");
          btn.innerText = ch;
          btn.onclick = () => checkMC(ch);
          optsArea.appendChild(btn);
        });
      }
      // 2~4ì„¸íŠ¸: ì£¼ê´€ì‹
      else {
        qaArea.innerText = `ğŸ“ ëœ»: ${item.meaning}`;
        // ê°€ë¦¼ ë¹„ìœ¨
        let ratio = 1;
        if (currentSet === 2) ratio = 0.2;
        if (currentSet === 3) ratio = 0.5;
        if (currentSet === 4) ratio = 1.0;
        const masked = maskWord(item.word, ratio);
        const p = document.createElement("p");
        p.innerText = masked;
        inputArea.appendChild(p);
        const inp = document.createElement("input");
        inp.type = "text";
        inp.placeholder = "ì •ë‹µì„ ì…ë ¥í•˜ì„¸ìš”";
        inputArea.appendChild(inp);
        const btn = document.createElement("button");
        btn.innerText = "ì œì¶œ";
        btn.onclick = () => checkInput(inp.value.trim());
        inputArea.appendChild(btn);
      }
    }

    // --- ë‹¨ì–´ ê°€ë¦¬ê¸° í•¨ìˆ˜ ---
    function maskWord(word, hideRatio) {
      const arr = word.split("");
      const hideCount = Math.floor(arr.length * hideRatio);
      const idxs = [];
      while (idxs.length < hideCount) {
        const i = Math.floor(Math.random() * arr.length);
        if (!idxs.includes(i)) idxs.push(i);
      }
      idxs.forEach(i => arr[i] = "_");
      return arr.join("");
    }

    // --- ê°ê´€ì‹ ì •ë‹µ ì²´í¬ ---
    function checkMC(choice) {
      const item = vocabList[qIndex];
      const fb = document.getElementById("feedback");
      if (choice === item.meaning) {
        score += 10;
        fb.innerText = "ğŸ‰ ì •ë‹µì…ë‹ˆë‹¤!";
      } else {
        fb.innerText = `âœ– í‹€ë ¸ìŠµë‹ˆë‹¤! ì •ë‹µ: ${item.meaning}`;
      }
      document.getElementById("next-btn").style.display = "inline-block";
    }

    // --- ì£¼ê´€ì‹ ì •ë‹µ ì²´í¬ ---
    function checkInput(answer) {
      const item = vocabList[qIndex];
      const fb = document.getElementById("feedback");
      if (answer.toLowerCase() === item.word.toLowerCase()) {
        score += 10;
        fb.innerText = "ğŸ‰ ì •ë‹µì…ë‹ˆë‹¤!";
      } else {
        fb.innerText = `âœ– í‹€ë ¸ìŠµë‹ˆë‹¤! ì •ë‹µ: ${item.word}`;
      }
      document.getElementById("next-btn").style.display = "inline-block";
    }

    // --- ë‹¤ìŒ ë¬¸ì œ / ì„¸íŠ¸ ì „í™˜ or ê²°ê³¼ ---
    document.getElementById("next-btn").onclick = () => {
      qIndex++;
      if (qIndex < vocabList.length) {
        runQuestion();
      } else {
        if (currentSet < 4) {
          currentSet++;
          qIndex = 0;
          runQuestion();
        } else {
          showResult();
        }
      }
    };

    // --- ê²°ê³¼ í™”ë©´ ---
    function showResult() {
      document.getElementById("quiz-screen").style.display = "none";
      document.getElementById("result-screen").style.display = "block";
      const elapsed = Math.floor((Date.now() - startTime) / 1000);
      document.getElementById("score-display").innerText = 
        `${playerName}ë‹˜, ì´ ì ìˆ˜: ${score}ì  (ì†Œìš”ì‹œê°„: ${elapsed}ì´ˆ)`;
    }

    // --- ì ìˆ˜ ì „ì†¡ ë²„íŠ¼ ---
    document.getElementById("submit-btn").onclick = () => {
      const elapsed = Math.floor((Date.now() - startTime) / 1000);
      saveData("vocabGame", playerName, score, elapsed);
    };

    // --- ì œê³µí•´ì£¼ì‹  saveData í•¨ìˆ˜ ---
    function saveData(game, name, score, elapsedTime) {
      const FUNCTION_URL = "https://us-central1-record-f420d.cloudfunctions.net/report";
      const requestData = {
        game,
        name,
        score: parseInt(score, 10),
        elapsedTime: parseInt(elapsedTime, 10)
      };
      try {
        const response = fetch(FUNCTION_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(requestData)
        });
        response.then(res => res.json()).then(data => {
          if (response.ok) {
            document.getElementById('response').innerText =
              `ì„±ê³µ: ${JSON.stringify(data, null, 2)}`;
          } else {
            document.getElementById('response').innerText =
              `ì˜¤ë¥˜: ${JSON.stringify(data, null, 2)}`;
          }
        });
      } catch (error) {
        console.error('ìš”ì²­ ì‹¤íŒ¨:', error);
        document.getElementById('response').innerText =
          `ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜: ${error.message}`;
      }
    }
  </script>
</body>
</html>
